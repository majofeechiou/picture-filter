!function(t){function e(n){if(i[n])return i[n].exports;var a=i[n]={exports:{},id:n,loaded:!1};return t[n].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){t.exports=i(2)},function(t,e){"use strict";function i(t){return t?n(t):void 0}function n(t){for(var e in i.prototype)t[e]=i.prototype[e];return t}t.exports=i,i.prototype.on=i.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},i.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this},i.prototype.off=i.prototype.removeListener=i.prototype.removeAllListeners=i.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i=this._callbacks["$"+t];if(!i)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var n,a=0;a<i.length;a++)if(n=i[a],n===e||n.fn===e){i.splice(a,1);break}return this},i.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),i=this._callbacks["$"+t];if(i){i=i.slice(0);for(var n=0,a=i.length;a>n;++n)i[n].apply(this,e)}return this},i.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},i.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e,i){"use strict";i(3)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();!function(t){var e=i(1),s=function(){function e(t,i){n(this,e),this.WEAK_MAP=new WeakMap,this.initConst=function(t){var e={};return this.WEAK_MAP.set(t,e),e},this.getConst=function(t){return this.WEAK_MAP.get(t)},this.addConst=function(t,e,i){var n=this.WEAK_MAP||{};return n[e]=i,this.WEAK_MAP.set(t,n),n},this.defaultAction(t,i)}return a(e,[{key:"setImageInitData",value:function(t){this.image_init_data=t,c.emit("initData.changed",{origin_data:t})}},{key:"getMainSection",value:function(){return this.getConst(this).MAIN_SECTION}},{key:"getObjCanvasPreview",value:function(){return this.getConst(this).OBJ_CANVAS_PREVIEW}},{key:"getPreviewSize",value:function(){return this.getConst(this).PREVIEW_SIZE}},{key:"getObjUpload",value:function(){return this.getConst(this).OBJ_UPLOAD}},{key:"makeTempate",value:function(){var t=document.createElement("input");t.type="file";var e=this.getPreviewSize(),i=document.createElement("canvas");i.setAttribute("data-obj","preview"),i.width=e.width,i.height=e.height;var n=this.getMainSection();void 0!==n&&(this.uploadAction.call(t,this),this.addConst(this,"OBJ_UPLOAD",t),this.addConst(this,"OBJ_CANVAS",i),n.appendChild(t),n.appendChild(i),this.addConst(this,"OBJ_CANVAS_PREVIEW",n.querySelectorAll('[data-obj="preview"]')[0]))}},{key:"defaultAction",value:function(t,e){this.initConst(this),e=e||{},e.width=e.width>0?e.width:600,e.height=e.height>0?e.height:450,t.nodeType>=1&&(this.addConst(this,"MAIN_SECTION",t),this.addConst(this,"PREVIEW_SIZE",e),this.makeTempate())}},{key:"uploadAction",value:function(e){var i=this;i.onchange=function(i){var n=t.URL||t.webkitURL,a=n.createObjectURL(this.files[0]);e.setImageInitData(a)}}}]),e}(),o=function(){function t(){n(this,t);var e=this;this.obj_canvas=document.createElement("canvas"),this.obj_canvas_2d=this.obj_canvas.getContext("2d"),console.log("this.obj_canvas :: ",this.obj_canvas),console.log("this.obj_canvas_2d :: ",this.obj_canvas_2d),this.obj_image=new Image,this.obj_image.onload=function(){var t=this.width,i=this.height;e.obj_canvas_2d.drawImage(this,0,0,t,i);for(var n=0;500>=n;n++){var a=Math.floor(Math.random()*t),s=Math.floor(Math.random()*i);e.obj_canvas_2d.fillStyle="white",e.obj_canvas_2d.beginPath(),e.obj_canvas_2d.arc(a,s,3,0,2*Math.PI,!0),e.obj_canvas_2d.closePath(),e.obj_canvas_2d.fill()}var o=e.obj_canvas.toDataURL();c.emit("imageData.step.computed",{origin_data:this.src,data:o})}}return a(t,[{key:"changeData",value:function(t){this.obj_image.src=t}}]),t}(),r=function l(){n(this,l);var t=this;this.step_data=[],c.on("initData.changed",function(e){t.step_data=[];var i=arguments[0];h.changeData(i.origin_data)}),c.on("imageData.step.computed",function(e){var i=arguments[0];t.step_data.push(i)}),c.emit("imageData.step.computed")};t.mainImageGilter=s;var c=new e,h=(new r,new o),u=document.querySelectorAll('[data-majo="picture-filter"]');new s(u[0]),new s(u[1],{width:450,height:100})}(window)}]);