!function(e){function t(i){if(n[i])return n[i].exports;var a=n[i]={exports:{},id:i,loaded:!1};return e[i].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";n(2)},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();!function(e){var t=function(){function t(e,i){n(this,t),this.WEAK_MAP=new WeakMap,this.initConst=function(e){var t={};return this.WEAK_MAP.set(e,t),t},this.getConst=function(e){return this.WEAK_MAP.get(e)},this.addConst=function(e,t,n){var i=this.WEAK_MAP||{};return i[t]=n,this.WEAK_MAP.set(e,i),i},this.defaultAction(e,i)}return i(t,[{key:"setNowCreaterIndex",value:function(e){this.now_creator_index=e}},{key:"setImageOriginData",value:function(e){this.image_origin_data=e}},{key:"getNowCreaterIndex",value:function(){return this.now_creator}},{key:"getNowCreater",value:function(){return _creator[this.getNowCreaterIndex()]}},{key:"getMainSection",value:function(){return this.getConst(this).MAIN_SECTION}},{key:"getObjCanvasPreview",value:function(){return this.getConst(this).OBJ_CANVAS_PREVIEW}},{key:"getPreviewSize",value:function(){return this.getConst(this).PREVIEW_SIZE}},{key:"getObjUpload",value:function(){return this.getConst(this).OBJ_UPLOAD}},{key:"makeTempate",value:function(){var e=document.createElement("input");e.type="file";var t=this.getPreviewSize(),n=document.createElement("canvas");n.setAttribute("data-obj","preview"),n.width=t.width,n.height=t.height;var i=this.getMainSection();void 0!==i&&(this.addConst(this,"OBJ_UPLOAD",e),this.addConst(this,"OBJ_CANVAS",n),i.appendChild(e),i.appendChild(n),this.addConst(this,"OBJ_CANVAS_PREVIEW",i.querySelectorAll('[data-obj="preview"]')[0]))}},{key:"defaultAction",value:function(e,t){this.initConst(this),t=t||{},t.width=t.width>0?t.width:600,t.height=t.height>0?t.height:450,e.nodeType>=1&&(this.addConst(this,"MAIN_SECTION",e),this.addConst(this,"PREVIEW_SIZE",t),this.makeTempate())}},{key:"changeImageDataSnow",value:function(e,t,n){var i=document.createElement("canvas"),a=i.getContext("2d"),r=e.width,o=e.height;i.width=r,i.height=o,a.drawImage(e,0,0,r,o),console.log(r,o),this.drawImageCover(a,e,0,0,r,o);for(var s=0;500>=s;s++){var h=Math.floor(Math.random()*r),u=Math.floor(Math.random()*o);a.fillStyle="white",a.beginPath(),a.arc(h,u,3,0,2*Math.PI,!0),a.closePath(),a.fill()}document.getElementsByTagName("body")[0].appendChild(i);var c=i.toDataURL();return c}},{key:"drawImageCover",value:function(e,t,n,i,a,r,o,s){2===arguments.length&&(n=i=0,a=e.canvas.width,r=e.canvas.height),o="number"==typeof o?o:.5,s="number"==typeof s?s:.5,0>o&&(o=0),0>s&&(s=0),o>1&&(o=1),s>1&&(s=1);var h=t.width,u=t.height,c=Math.min(a/h,r/u),d=h*c,l=u*c,g=void 0,v=void 0,f=void 0,w=void 0,m=1;a>d&&(m=a/d),r>l&&(m=r/l),d*=m,l*=m,f=h/(d/a),w=u/(l/r),g=(h-f)*o,v=(u-w)*s,0>g&&(g=0),0>v&&(v=0),f>h&&(f=h),w>u&&(w=u),e.drawImage(t,g,v,f,w,n,i,a,r)}},{key:"create",value:function(){var t=this;this.getObjUpload().onchange=function(n){var i=e.URL||e.webkitURL,a=i.createObjectURL(this.files[0]);t.setImageOriginData(a);var r=(t.getMainSection(),t.getObjCanvasPreview()),o=r.getContext("2d");r.style.border="1px solid #f00";var s=new Image;s.onload=function(){var e=t.changeImageDataSnow(s,t.getPreviewSize().width,t.getPreviewSize().height),n=new Image;console.log("_bb_snow :: ",e),n.onload=function(){t.drawImageCover(o,n,0,0,t.getPreviewSize().width,t.getPreviewSize().height)},n.src=e,n.crossOrigin=null},s.src=a,console.log("_bb :: ",a),s.crossOrigin=null}}}]),t}();e.Pfilter=t;var a=document.querySelectorAll('[data-majo="picture-filter"]'),r=new t(a[0]),o=new t(a[1],{width:450,height:100});r.create(),o.create()}(window)}]);