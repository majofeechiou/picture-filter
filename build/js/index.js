!function(t){function e(i){if(a[i])return a[i].exports;var n=a[i]={exports:{},id:i,loaded:!1};return t[i].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var a={};return e.m=t,e.c=a,e.p="",e(0)}([function(t,e,a){t.exports=a(2)},function(t,e){"use strict";function a(t){return t?i(t):void 0}function i(t){for(var e in a.prototype)t[e]=a.prototype[e];return t}t.exports=a,a.prototype.on=a.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},a.prototype.once=function(t,e){function a(){this.off(t,a),e.apply(this,arguments)}return a.fn=e,this.on(t,a),this},a.prototype.off=a.prototype.removeListener=a.prototype.removeAllListeners=a.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var a=this._callbacks["$"+t];if(!a)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i,n=0;n<a.length;n++)if(i=a[n],i===e||i.fn===e){a.splice(n,1);break}return this},a.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),a=this._callbacks["$"+t];if(a){a=a.slice(0);for(var i=0,n=a.length;n>i;++i)a[i].apply(this,e)}return this},a.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},a.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e,a){"use strict";a(3)},function(t,e,a){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,a,i){return a&&t(e.prototype,a),i&&t(e,i),e}}();!function(t){var e=a(1),o=function(){function e(t,a){i(this,e),this.WEAK_MAP=new WeakMap,this.initConst=function(t){var e={};return this.WEAK_MAP.set(t,e),e},this.getConst=function(t){return this.WEAK_MAP.get(t)},this.addConst=function(t,e,a){var i=this.WEAK_MAP||{};return i[e]=a,this.WEAK_MAP.set(t,i),i},this.defaultAction(t,a)}return n(e,[{key:"setImageInitData",value:function(t){this.image_init_data=t,c.emit("initData.changed",{origin_data:t})}},{key:"getMainSection",value:function(){return this.getConst(this).MAIN_SECTION}},{key:"getObjCanvasPreview",value:function(){return this.getConst(this).OBJ_CANVAS_PREVIEW}},{key:"getPreviewSize",value:function(){return this.getConst(this).PREVIEW_SIZE}},{key:"getObjUpload",value:function(){return this.getConst(this).OBJ_UPLOAD}},{key:"makeTempate",value:function(){var t=document.createElement("input");t.type="file";var e=this.getPreviewSize(),a=document.createElement("canvas");a.setAttribute("data-obj","preview"),a.width=e.width,a.height=e.height;var i=this.getMainSection();void 0!==i&&(this.uploadAction.call(t,this),this.addConst(this,"OBJ_UPLOAD",t),this.addConst(this,"OBJ_CANVAS",a),i.appendChild(t),i.appendChild(a),this.addConst(this,"OBJ_CANVAS_PREVIEW",i.querySelectorAll('[data-obj="preview"]')[0]))}},{key:"defaultAction",value:function(t,e){this.initConst(this),e=e||{},e.width=e.width>0?e.width:600,e.height=e.height>0?e.height:450,t.nodeType>=1&&(this.addConst(this,"MAIN_SECTION",t),this.addConst(this,"PREVIEW_SIZE",e),this.makeTempate())}},{key:"uploadAction",value:function(e){var a=this;a.onchange=function(a){var i=t.URL||t.webkitURL,n=i.createObjectURL(this.files[0]);e.setImageInitData(n)}}}]),e}(),s=function(){function t(){i(this,t);var e=this;e.obj_canvas=document.createElement("canvas"),e.obj_canvas_2d=e.obj_canvas.getContext("2d"),e.obj_image=new Image,c.on("imageData.step.success.loaded",function(t){var a=arguments[0],i=a.painter_method;"SNOW"===i?e.methodSnow(a):"DOT"===i?(console.log("DOT"),e.methodDot(a)):console.log("ooooother")}),e.obj_image.onload=function(){if("string"==typeof this.src&&""!==this.src){var t=this.width,a=this.height;e.obj_canvas_2d.drawImage(this,0,0,t,a),c.emit("imageData.step.success.loaded",{origin_data:this.src,painter_method:e.getPainterMethod(),image_width:t,image_height:a})}else console.log("***")},e.obj_image.error=function(){c.emit("imageData.step.error.loaded",{origin_data:this.src})}}return n(t,[{key:"getPainterMethod",value:function(){var t=this;return t.painter_method}},{key:"changeData",value:function(t,e){var a=this;a.painter_method=t,a.obj_image.src=e}},{key:"methodSnow",value:function(t){for(var e=this,a=t.image_width,i=t.image_height,n=void 0,o=void 0,s=0;500>=s;s++)n=Math.floor(Math.random()*a),o=Math.floor(Math.random()*i),e.obj_canvas_2d.fillStyle="white",e.obj_canvas_2d.beginPath(),e.obj_canvas_2d.arc(n,o,3,0,2*Math.PI,!0),e.obj_canvas_2d.closePath(),e.obj_canvas_2d.fill();var r=e.obj_canvas.toDataURL();c.emit("imageData.step.success.computed",{origin_data:t.origin_data,data:r})}},{key:"methodDot",value:function(t){for(var e=this,a=t.image_width,i=t.image_height,n=void 0,o=void 0,s=0;150>=s;s++)n=Math.floor(Math.random()*a),o=Math.floor(Math.random()*i),e.obj_canvas_2d.fillStyle="black",e.obj_canvas_2d.beginPath(),e.obj_canvas_2d.arc(n,o,5,0,2*Math.PI,!0),e.obj_canvas_2d.closePath(),e.obj_canvas_2d.fill();var r=e.obj_canvas.toDataURL();document.getElementsByTagName("body")[0].appendChild(e.obj_canvas),c.emit("imageData.step.success.computed",{origin_data:t.origin_data,data:r})}}]),t}(),r=function u(){i(this,u);var t=this;this.step_data=[],c.on("initData.changed",function(e){t.step_data=[];var a=arguments[0];h.changeData("SNOW",a.origin_data)}),c.on("imageData.step.success.computed",function(e){var a=arguments[0];a&&"string"==typeof a.origin_data&&""!==a.origin_data&&(t.step_data.push(a),console.log("_scope.step_data :: ",t.step_data),1===t.step_data.length&&t.step_data[0]&&h.changeData("DOT",a.data),console.log("_scope.step_data :: ",t.step_data))}),c.emit("imageData.step.success.computed")};t.mainImageGilter=o;var c=new e,h=(new r,new s),l=document.querySelectorAll('[data-majo="picture-filter"]');new o(l[0]),new o(l[1],{width:450,height:100})}(window)}]);